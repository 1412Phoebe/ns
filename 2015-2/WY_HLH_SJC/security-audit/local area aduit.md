# 基于网络安全审计针对局域网ARP欺骗的检测与防御

## 基于网络安全审计ARP欺骗检测的主要方法

* 分析路由器日志
   * 1.什么是路由器日志
     路由器的一些重要信息可以通过syslog机制在内部网络的UNIX主机上作日志。日志功能可通过在路由器上设定日志主机的IP地址，并在相应的UNIX主机上作一些必要的设置来实现在路由器运行过程中路由器会向日志主机发送日志。日志包括链路建立失败信息包过滤日志信息等等。通过登录到日志主机，系统管理员可以了解日志事件，对日志进行分析。日志可以帮助管理员进行故障定位、故障排除，还可以帮助管理员对网络安全进行管理。
   * 2.分析该日志的原因
     当发生ARP欺骗攻击时，路由器日志中会记录大量冲突信息，这些信息会包含攻击者的MAC。这主要是因为攻击者和被攻击者抢夺路由器ARP对应关系表造成的，这种情况我们即可通过分析路由器日志查找攻击源并进行定位和适时公布对应的房间或人员。
   * 3.实现过程
     首先系统是基于linux操作系统平台，首先配置路由器，将日志信息输出到某固定IP的机器中，然后再配置Syslogd(syslogd可以负责记录系统运作中，kernel或应用程式产生的各种讯息。)软件，接收路由器日志信息输出，然后通过编制多个Shell脚本程序，分析syslogd接收的路由器日志，进而确定ARP欺骗源的MAC地址，然后使用SNMP协议软件提取路由器ARP表，确定ARP欺骗攻击源MAC地址。然后使用SNMP协议相关软件的snmpwalk命令到所有交换机中去扫描查找该MAC地址对应的接入端口，最后可通过snmpwalk命令关闭相应端口，最后公布相应的MAC地址信息。




