#对常见的ARP欺骗攻击进行总结和分类

   ARP欺骗攻击是针对局域网环境常用的攻击手段，会影响网络的正常通信。ARP欺骗攻击主要有三类，分别为：
   
   1.终端ARP缓存投毒
   
   2.交换机DoS攻击
   
   3.交换机投毒者

#终端ARP缓存投毒#


假如主机A要与目的主机B进行通信，为了查找与目的主机IP地址相对应的MAC地址，主机A使用ARP协议来查找目的主机B的MAC地址。首先， 源主机A会以广播的形式发送一个ARP请求数据包给以太网上的每一台主机，这个过程称为ARP广播。而在接收到ARP广播的所有计算机中，只有 具有目的主机IP地址的主机B收到该广播报文后，才会向源主机A回送一个包含其MAC地址的应答，这样一次正常的地址解析过程就完成了。为 了尽量减少网络中ARP广播请求的次数，每台主机都拥有一个ARP缓存，这个缓存存放了自主机启动以来所有的IP地址与MAC地址之间的映射记 录。主机每隔一定时间或者每当收到ARP应答，都会用新的地址映射记录对ARP缓存进行更新，以保证自己拥有最新的地址解析缓存。

利用ARP协议的缓存更新不需要验证的特点，就可以冒用一个合法IP，对同网络的数据进行嗅探，而这正是ARP欺骗病毒所采用的手段.

#交换机DoS攻击

交换机主动学习局域网中主机的MAC地址，并建立和维护端口和MAC地址的对应表以此建立交换路径，这个表就是通常我们所说的CAM表。CAM表的大小是固定的，不同的交换机的CAM表大小不同。交换机DoS攻击是指利用工具不断发送去往未知目的地的数据帧，从而快速填满CAM表。当交换机CAM表被填满后，迫使交换机退化为HUB，进广播状态，使内网由交换式网络退化成共享式网络。内网中的嗅探者又可以对网络进行监听。

#交换机投毒者

交换机里面有一张CAM表，记录了Mac－Port信息。所谓欺骗交换机缓存，就是修改这张CAM表以达到欺骗交换机的目的！比如现在有一个4端口的交换机，它的CAM表如下：

11-11-11-11-11-11  -- port1；22-22-22-22-22-22  -- port2；33-33-33-33-33-33  -- port3 
  
现在位于port1的主机A（IP是192.168.1.3，MAC地址为11-11-11-11-11-11）想要嗅探位于port2的主机B（IP是192.168.1.4，MAC地址为22-22-22-22-22-22）。实现流程如下：

主机A对外发送一个数据包，如下：

SrcIP:192.168.1.3 ScrMac:22-22-22-22-22-22

DstIP:xxx.xxx.xxx.xxx（随便写），DstMac:xx-xx-xx-xx-xx-xx（随便写）

此时，交换机收到这个包，发现在原来CAM里面，port1对应的机器MAC地址是11-11-11-11-11-11，现在变为：22-22-22-22-22-22，则更新CAM表

更新后的交换机CAM表如下：

22-22-22-22-22-22  -- port1；22-22-22-22-22-22  -- port2；33-33-33-33-33-33  -- port3 

在处于PORT 3的主机向port 2的主机发送数据时，在查询port1时，发现此端口对应MAC地址和数据包里的MAC地址相同，交换机直接就把包转发到port1的主机了。同理，攻击主机还需要对将port 1对应的MAC地址进行相同的处理，最后变成33-33-33-33-33-33，这时攻击主机又可以获得处于PORT 2的主机向处于port 3的主机发送的数据包。


 
